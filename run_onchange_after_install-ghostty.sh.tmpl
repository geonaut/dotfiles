#!/bin/bash

# Define helper for this script (in case it runs standalone)
YELLOW='\033[1;33m'
RESET='\033[0m'
warn() { echo -e "${YELLOW}‚ö†Ô∏è  $1${RESET}"; }

# Only attempt install if not on a server
{{ if not .is_server -}}

echo "üöÄ Attempting to install Ghostty binary..."

# We use a subshell ( ) to capture the installer's exit status 
# without letting it kill our main script.
if bash -c "$(curl -fsSL https://raw.githubusercontent.com/mkasberg/ghostty-ubuntu/main/install.sh)"; then
    echo "‚úÖ Ghostty installed successfully."
else
    # This block triggers if the installer returns exit status 1
    warn "Ghostty installation failed (likely OS version incompatibility)."
    warn "Skipping Ghostty setup, but continuing with the rest of Geonaut..."
fi

{{ else -}}
echo "‚ÑπÔ∏è  Server environment detected. Skipping Ghostty install."
{{ end -}}

# Exit 0 ensures chezmoi marks this script as 'run' even if Ghostty failed
exit 0